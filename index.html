<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JDN - חדשות חרדים</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;800&display=swap');
        body { font-family: 'Assistant', sans-serif; background-color: #f2f2f2; margin: 0; padding: 0; }
        
        /* צבעים ולוגו */
        .header-top { background: linear-gradient(90deg, #17298D 0%, #2847F3 100%); border-bottom: 4px solid #e31e24; }
        .nav-bar { background: white; border-bottom: 1px solid #ddd; }
        .jdn-red { background-color: #e31e24; }

        /* מבנה גריד מקצועי */
        .wrapper { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 300px; gap: 15px; padding: 15px; }
        
        .main-grid { display: grid; grid-template-columns: repeat(4, 1fr); grid-auto-rows: 190px; gap: 8px; }

        /* כתבה ראשית גדולה */
        .main-card { grid-column: span 2; grid-row: span 2; position: relative; overflow: hidden; }
        /* ריבוע רגיל */
        .sub-card { position: relative; overflow: hidden; background: #fff; }

        .card-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s; }
        .card-overlay { 
            position: absolute; bottom: 0; right: 0; left: 0; 
            background: linear-gradient(transparent, rgba(0,0,0,0.9)); 
            padding: 15px; color: white; z-index: 2;
        }

        .main-title { font-size: 1.8rem; font-weight: 800; line-height: 1.1; }
        .sub-title { font-size: 1rem; font-weight: 700; line-height: 1.2; }

        /* טור מבזקים צדדי */
        .side-ticker { background: white; border-radius: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .ticker-head { background: #17298D; color: white; padding: 10px; font-weight: bold; text-align: center; }
        .ticker-entry { padding: 10px; border-bottom: 1px solid #eee; font-size: 0.9rem; display: flex; gap: 10px; }
        .t-time { color: #e31e24; font-weight: bold; }

        @media (max-width: 1024px) { .wrapper { grid-template-columns: 1fr; } .side-ticker { display: none; } }
    </style>
</head>
<body>

    <div class="header-top py-4">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <img src="https://www.jdn.co.il/wp-content/uploads/2022/01/logosite.png" class="h-16">
            <div class="hidden md:block text-white text-sm">האתר החרדי המוביל בעולם</div>
        </div>
    </div>

    <div class="nav-bar hidden md:block">
        <div class="container mx-auto px-4 flex gap-8 py-3 font-bold text-gray-800">
            <a href="#" class="hover:text-blue-700">דף הבית</a>
            <a href="#" class="hover:text-blue-700">חדשות</a>
            <a href="#" class="hover:text-blue-700">פוליטיקה</a>
            <a href="#" class="hover:text-blue-700">חצרות קודש</a>
            <a href="#" class="hover:text-blue-700">כלכלה</a>
        </div>
    </div>

    <div class="jdn-red text-white py-1 font-bold shadow-md">
        <div class="container mx-auto px-4 flex items-center">
            <div class="bg-white text-red-600 px-3 ml-4 text-sm">חדשות</div>
            <marquee id="marquee-bar" behavior="scroll" direction="right" class="text-sm">טוען מבזקים אחרונים...</marquee>
        </div>
    </div>

    <div class="wrapper">
        
        <div class="main-grid" id="jdn-grid">
            </div>

        <aside class="side-ticker">
            <div class="ticker-head text-lg">מבזקי JDN</div>
            <div id="sidebar-list">
                </div>
        </aside>

    </div>

    <script>
        async function fetchJDN() {
            const repo = "yy0534105830-source/news";
            const res = await fetch(`https://api.github.com/repos/${repo}/contents/content/blog`);
            const data = await res.json();
            
            const grid = document.getElementById('jdn-grid');
            const sidebar = document.getElementById('sidebar-list');
            const marquee = document.getElementById('marquee-bar');

            let marqueeContent = "";
            let sidebarHTML = "";
            let gridHTML = "";

            for (let file of data) {
                if (file.name.endsWith('.md')) {
                    const contentRes = await fetch(file.download_url);
                    const text = await contentRes.text();
                    
                    const title = text.match(/title: "(.*)"/)?.[1] || "";
                    const img = text.match(/image: "(.*)"/)?.[1] || "";
                    const pos = text.match(/layout_position: "(.*)"/)?.[1];
                    const dateMatch = text.match(/date: "(.*)"/)?.[1] || "";
                    const time = dateMatch.split(' ')[1] || "08:00";

                    if (pos === "ticker") {
                        marqueeContent += ` • ${title} `;
                        sidebarHTML += `
                            <div class="ticker-entry">
                                <span class="t-time">${time}</span>
                                <span>${title}</span>
                            </div>`;
                    } else {
                        const isTop = (pos === "top");
                        gridHTML += `
                            <div class="${isTop ? 'main-card' : 'sub-card'} shadow hover:shadow-xl cursor-pointer">
                                <img src="${img}" class="card-img">
                                <div class="card-overlay">
                                    <h2 class="${isTop ? 'main-title' : 'sub-title'}">${title}</h2>
                                </div>
                            </div>`;
                    }
                }
            }
            grid.innerHTML = gridHTML;
            sidebar.innerHTML = sidebarHTML;
            marquee.innerHTML = marqueeContent;
        }
        fetchJDN();
    </script>
</body>
</html>
